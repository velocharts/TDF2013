<!DOCTYPE html>
<html lang="en">
	<head>
		
		<title>Tour de France Stage by Stage</title>

		<script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
	<style>	
	body
{
background-color:rgb(240,240,240);
}
 #header {
	font-size: 18px;
   font-family: Helvetica, Arial, Sans-Serif;
   color: rgb(80,80,80);
   }
 		
			.axis path,
			.axis line {
				fill: none;
				stroke: grey;
				shape-rendering: crispEdges;
				
			}
			
			.axis text {
				font-family: sans-serif;
				font-size: 13px;
				fill: rgb(80,80,80);
			}
				
		a, img {
    border:none;
}

   .aParent div {
  float: left;
  clear: none; 
}

#dropDown, #dropDown2, #dropDown3 {
	font-size: 13px;
   font-family: Helvetica, Arial, Sans-Serif;
   color: rgb(80,80,80);
   }

</style>
		
	</head>
	   <body>
	<div class="aParent">
	<img src="images/TDFBanner.png" />
	<div id="left margin" style="width:60px"><br></div>
	<div id="dropdowns" style="width:300px">
		
<form id="dropDown">
1. Select team to highlight in blue:
<select id="myList">
<option>SKY PROCYCLING</option>
<option>MOVISTAR TEAM</option>
 <option>BELKIN PRO CYCLING</option> 
  <option>AG2R LA MONDIALE</option>
  <option>ASTANA PRO TEAM</option>
    <option>TEAM SAXO-TINKOFF</option>
<option>OMEGA PHARMA-QUICK STEP</option>
  <option>BMC RACING TEAM</option>
  <option>CANNONDALE</option>
  <option>COFIDIS</option>
  <option>EUSKALTEL - EUSKADI</option>
  <option>FDJ.FR</option>
  <option>GARMIN - SHARP</option>
  <option>KATUSHA TEAM</option>
  <option>LAMPRE - MERIDA</option>
  <option>KATUSHA TEAM</option>
  <option>LOTTO-BELISOL</option>
  <option>ORICA GREENEDGE</option>
  <option>RADIOSHACK LEOPARD</option>
    <option>SOJASUN</option>
  <option>TEAM ARGOS-SHIMANO</option>
  <option>TEAM EUROPCAR</option>
  <option>VACANSOLEIL-DCM</option>
  
</select>
<br><br>
<form id="dropDown2">
2. Select rider to highlight in red:
<select id="myListR">
  <option>FROOME Christopher</option>
    <option>QUINTANA ROJAS Nairo Alexander</option>
    <option>RODRIGUEZ OLIVER Joaquin</option>
  	  <option>CONTADOR Alberto</option>
	  <option>KREUZIGER Roman</option>
  <option>MOLLEMA Bauke</option>  
<option>FUGLSANG Jakob</option>
 <option>VALVERDE Alejandro</option>
  <option>TALANSKY Andrew</option>
   <option>KWIATKOWSKI Michal</option>
      <option>TEN DAM Laurens</option>
  <option>MARTIN Daniel</option>
 <option>NIEVE ITURRALDE Mikel</option>
 <option>BARDET Romain</option>
  <option>COSTA Rui Alberto</option>
 
  <option>SCHLECK Andy</option>
  <option>EVANS Cadel</option>
  <option>ROGERS Michael</option>
 
  <option>ROLLAND Pierre</option>
  <option>GESINK Robert</option>
  <option>PORTE Richie</option>
  <option>CUNEGO Damiano</option>
  <option>HESJEDAL Ryder</option>
  <option>IMPEY Daryl</option>
  <option>BAKELANTS Jan</option>
 
  <option>GERRANS Simon</option>
	<option>GERRANS Simon</option>
    <option>SAGAN Peter</option>
<option>VOECKLER Thomas</option>
		  <option>MILLAR David</option>



  
</select>
<br><br>
</form>
<form id="dropDown3">
3. Cycle Through Stages Using Dropdown Box:
<select id="stageList">
  <option>Stage 1</option>
  <option>Stage 2</option>
  <option>Stage 3</option>  
  <option>Stage 4</option>
  <option>Stage 5</option>
  <option>Stage 6</option>
  <option>Stage 7</option>
  <option>Stage 8</option>
  <option>Stage 9</option>
  <option>Stage 10</option>
  <option>Stage 11</option>
   <option>Stage 12</option>
    <option>Stage 13</option>
	<option>Stage 14</option>
	<option>Stage 15</option>
	<option>Stage 16</option>
	<option>Stage 17</option>
	<option>Stage 18</option>
	<option>Stage 19</option>
	<option>Stage 20</option>
	<option>Stage 21</option>
</select>

</form>
				<br><p1 id="header"></p1>
	</div id="profiles" style="width:400px">

	<p>
        <img alt="" src="images/PROFIL1.png" 
            style="height: 140px; width: 250px" id="imgClickAndChange" />
</p>
</div>
</div>
	
	 <script type="text/javascript">
	
	var circle
	var data

	 
	//Width and height of SVG
		 	var data
			var w = 840;
			var h = 1050;
			var padding = 60;

var mylist=document.getElementById("myList");
var teamS=mylist.options[mylist.selectedIndex].text;

var myListR=document.getElementById("myListR");
var riderS=myListR.options[myListR.selectedIndex].text;

	
	//Data for starting overall standings
		d3.csv("Data/2013TDFALL.csv", function(error, data) {;
		data.forEach(function(d) {
    d.Position = +d.Position1;
    d.SecBack = +d.SecBack1;
	d.Position2 = +d.Position2;
    d.SecBack2 = +d.SecBack2;
	d.Position3 = +d.Position3;
    d.SecBack3 = +d.SecBack3;
	d.Position5 = +d.Position5;
    d.SecBack5 = +d.SecBack5;
	d.Position5 = +d.Position5;
    d.SecBack5 = +d.SecBack5;
	d.Position6 = +d.Position6;
    d.SecBack6 = +d.SecBack6;
	d.Position7 = +d.Position7;
    d.SecBack7 = +d.SecBack7;
	d.Position8 = +d.Position8;
    d.SecBack8 = +d.SecBack8;
	d.Position9 = +d.Position9;
    d.SecBack9 = +d.SecBack9;
	d.Position10 = +d.Position10;
    d.SecBack10 = +d.SecBack10;
	d.Position11 = +d.Position11;
    d.SecBack11 = +d.SecBack11;
	d.Position12 = +d.Position12;
    d.SecBack12 = +d.SecBack12;
	d.Position13 = +d.Position13;
   d.SecBack13 = +d.SecBack13;
   	d.Position14 = +d.Position14;
   d.SecBack14 = +d.SecBack14;
   	d.Position15 = +d.Position15;
   d.SecBack15 = +d.SecBack15;
   d.Position16 = +d.Position16;
   d.SecBack16 = +d.SecBack16;
    d.Position17 = +d.Position17;
   d.SecBack17 = +d.SecBack17;
       d.Position18 = +d.Position18;
   d.SecBack18 = +d.SecBack18;
     d.Position19 = +d.Position19;
   d.SecBack19 = +d.SecBack19;
       d.Position20 = +d.Position20;
   d.SecBack20 = +d.SecBack20;
       d.Position21 = +d.Position21;
   d.SecBack21 = +d.SecBack21;
	});
		
	//set scales for starting overall standings
		var xScale = d3.scale.linear()
                    .domain([0, d3.max(data, function(d) { return d.Position21; })])
				
                     .range([padding, w - padding]);
		var yScale = d3.scale.linear()
                     .domain([0, d3.max(data, function(d) { return d.SecBack21; })])
                     .range([padding, h - padding]);				 

					 //Define X axis
			var xAxis = d3.svg.axis()
							  .scale(xScale)
							  .orient("top")
							  .ticks(10);

			//Define Y axis
			var yAxis = d3.svg.axis()
							  .scale(yScale)
							  .orient("left")
							  .ticks(10);

	//Create SVG element
		var svg = d3.select("body")
						.append("svg")
						.attr("width", w)
						.attr("height", h);
//STARTING STANDINGS - Build starting overall standings circles					
				var circle = svg.selectAll("circle")
			   .data(data)
			   .enter()
			   .append("circle")
	// For starting standings circles lined up in middle of svg		   
			  .attr("cx", function(d) {
			   		return 100;})
			   .attr("cy", function(d) {
			   		return 100;})
	//set colour
	
			  .attr("fill", function(d) {
				 if (d.Name == riderS) { return "rgb(227,27,35)" }
			 else if (d.Team == teamS) { return "rgb(0,121,193)" }
			  else {  return "rgb(217,217,217)" }
			  })
			
			 
			.attr("stroke", "black")
			.attr("stroke-width", 0.5)	
			 .attr("r", function(d) {
			  if (d.Team == teamS) { return 6}
			  else if (d.Name == riderS) { return 6 }
			  else {  return 5 }
			  })
	//set up tool tips	
var tips = svg.selectAll("circle")	
			.append("title")
			.text(function(d) {
				return d.Name + " | Position: " + d.Position1 + " | " + d.Team + " | Overall Time:" + d.TimeBack1;});
			
//Create X axis
			svg.append("g")
				.attr("class", "x axis")
				.attr("transform", "translate(0," + (padding -15) + ")")
				.call(xAxis);
			
			//Create Y axis
			svg.append("g")
				.attr("class", "y axis")
				.attr("transform", "translate(" + padding + ",0)")
				.call(yAxis);		
				
	svg.append("text")
    .attr("class", "x label")
    .attr("text-anchor", "end")
    .attr("x", w / 3)
    .attr("y", 12)
	.attr("font-family", "sans-serif")
	.attr("fill", "rgb(90,90,90)")
    .text("General Classification - Position");	

	svg.append("text")
    .attr("class", "y label")
    .attr("text-anchor", "end")
	.attr("font-family", "sans-serif")
	.attr("fill", "rgb(90,90,90)")
    .attr("y", 3)
	.attr("x", - 80)
    .attr("dy", ".75em")
    .attr("transform", "rotate(-90)")
    .text("Seconds Back");
				
			 
			var circle = svg.selectAll("circle")
			    .data(data)
			    .transition()
			    .duration(5000)
			    .attr("cx", function(d) {
			   		return xScale(d.Position1);})
			   .attr("cy", function(d) {
			   		return yScale(d.SecBack1);})
					

		/*		//Create labels
			svg.selectAll("text")
			   .data(data)
			   .enter()
			   .append("text")
			   .text(function(d) {
			   		return d.Hname;})
			   .attr("x", function(d) {
			   		return xScale(d.Position);})
			   .attr("y", function(d) {
			   		return yScale(d.SecBack) + 18;})
			   .attr("font-family", "sans-serif")
			   .attr("text-anchor", "middle")
			   .attr("font-size", "11px")
			   .attr("fill", "black");	
			*/
			
				d3.select("#myList")
				.on("change", function() {
			var mylist=document.getElementById("myList");
var teamS=mylist.options[mylist.selectedIndex].text
var myListR=document.getElementById("myListR");
var riderS=myListR.options[myListR.selectedIndex].text;
		svg.selectAll("circle")
			   .data(data)
			    .transition()
			    .duration(1000)

	//set colour
			   .attr("fill", function(d) {
			 if (d.Name == riderS) { return "rgb(227,27,35)" }
			 else if (d.Team == teamS) { return "rgb(0,121,193)" }
			  else {  return "rgb(217,217,217)" }
			  })
			.attr("stroke", "black")
			.attr("stroke-width", 0.5)	
			 .attr("r", function(d) {
			  if (d.Team == teamS) { return 6}
			  else if (d.Name == riderS) { return 6 }
			  else {  return 5 }
			  })
				});
	//on change of rider dropdown			
						d3.select("#myListR")
				.on("change", function() {
		var myListR=document.getElementById("myListR");
var riderS=myListR.options[myListR.selectedIndex].text;
	var mylist=document.getElementById("myList");
var teamS=mylist.options[mylist.selectedIndex].text

		svg.selectAll("circle")
			   .data(data)
			    .transition()
			    .duration(1000)

	//set colour
			   .attr("fill", function(d) {
			 if (d.Name == riderS) { return "rgb(227,27,35)" }
			 else if (d.Team == teamS) { return "rgb(0,121,193)" }
			  else {  return "rgb(217,217,217)" }
			  })
			.attr("stroke", "black")
			.attr("stroke-width", 0.5)	
			 .attr("r", function(d) {
			  if (d.Team == teamS) { return 7}
			  else if (d.Name == riderS) { return 7 }
			  else {  return 5 }
			  })
				});
				
				
				d3.select("#stageList")
				.on("change", function() {
			var stageList=document.getElementById("stageList");
			
var stageN=stageList.options[stageList.selectedIndex].text


switch (stageN)
{
  case "Stage 1" : 
   document.getElementById("imgClickAndChange").src = "images/PROFIL1.png";
     data.forEach(function(d) {
    d.PositionZ = d.Position1;
	d.SecBackZ = d.SecBack1;
d.TimeBackZ = d.TimeBack1;
	
	});
     break;
case "Stage 2" : 
     //alert(stageN + " d.Position2");
	 document.getElementById("imgClickAndChange").src = "images/PROFIL2.png";
	 data.forEach(function(d) {
    d.PositionZ = d.Position2;
	d.SecBackZ = d.SecBack2;
d.TimeBackZ = d.TimeBack2;
	});
	break;
	case "Stage 3" : 
	 document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL3.png";
     
	 data.forEach(function(d) {
    d.PositionZ = d.Position3;
	d.SecBackZ = d.SecBack3;
d.TimeBackZ = d.TimeBack3;
	});
	
	break;
	case "Stage 4" : 
	 document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL4.png";
   
	 data.forEach(function(d) { 
    d.PositionZ = d.Position4;
	d.SecBackZ = d.SecBack4;
d.TimeBackZ = d.TimeBack4;
	});
  break;
  case "Stage 5" : 
   document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL5.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position5;
	d.SecBackZ = d.SecBack5;
	d.TimeBackZ = d.TimeBack5;
	});
	 break;
	case "Stage 6" : 
	 document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL6.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position6;
	d.SecBackZ = d.SecBack6;
	d.TimeBackZ = d.TimeBack6;
	});
  break;
  case "Stage 7" : 
   document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL7.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position7;
	d.SecBackZ = d.SecBack7;
	d.TimeBackZ = d.TimeBack7;
	});
  break;
  case "Stage 8" : 
   document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL8.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position8;
	d.SecBackZ = d.SecBack8;
	d.TimeBackZ = d.TimeBack8;
	});
  break;
  case "Stage 9" : 
   document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL9.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position9;
	d.SecBackZ = d.SecBack9;
	d.TimeBackZ = d.TimeBack9;
	});
  break;
  case "Stage 10" : 
   document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL10.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position10;
	d.SecBackZ = d.SecBack10;
		d.TimeBackZ = d.TimeBack10;
	});

  break;
  case "Stage 11" : 
   document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL11.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position11;
	d.SecBackZ = d.SecBack11;
	d.TimeBackZ = d.TimeBack11;
		
	});
	
  break;
  
   case "Stage 12" : 
   document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL12.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position12;
	d.SecBackZ = d.SecBack12;
	d.TimeBackZ = d.TimeBack12;
		
	});
	
  break;
 
   case "Stage 13" : 
   document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL13.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position13;
	d.SecBackZ = d.SecBack13;
	d.TimeBackZ = d.TimeBack13;
		
	});
	
  break;
   case "Stage 14" : 
   document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL14.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position14;
	d.SecBackZ = d.SecBack14;
	d.TimeBackZ = d.TimeBack14;
		
	});
	
  break;
     case "Stage 15" : 
   document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL15.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position15;
	d.SecBackZ = d.SecBack15;
	d.TimeBackZ = d.TimeBack15;
		
	});
	
  break;
   case "Stage 16" : 
   document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL16.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position16;
	d.SecBackZ = d.SecBack16;
	d.TimeBackZ = d.TimeBack16;
		
	});
	
  break;
  
   case "Stage 17" : 
   document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL17.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position17;
	d.SecBackZ = d.SecBack17;
	d.TimeBackZ = d.TimeBack17;
		
	});
	
  break;
  
    case "Stage 18" : 
   document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL18.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position18;
	d.SecBackZ = d.SecBack18;
	d.TimeBackZ = d.TimeBack18;
		
	});
	
  break;
  
  case "Stage 19" : 
   document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL19.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position19;
	d.SecBackZ = d.SecBack19;
	d.TimeBackZ = d.TimeBack19;
		
	});
	
  break;
  
  case "Stage 20" : 
   document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL20.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position20;
	d.SecBackZ = d.SecBack20;
	d.TimeBackZ = d.TimeBack20;
		
	});
	
  break;
  
  case "Stage 21" : 
   document.getElementById("imgClickAndChange").src = "http://dl.dropboxusercontent.com/u/17797293/VELOCHARTS/TDF2013/Standings/PROFIL21.png";
     //alert(stageN + " d.Position3");
	 data.forEach(function(d) {
  
    d.PositionZ = d.Position21;
	d.SecBackZ = d.SecBack21;
	d.TimeBackZ = d.TimeBack21;
		
	});
	
  break;
  
}


		svg.selectAll("circle")
			   .data(data)
			    .transition()
			    .duration(2000)
 .attr("cx", function(d) {
			   		return xScale(d.PositionZ);})
			   .attr("cy", function(d) {
			   		return yScale(d.SecBackZ);})
					
					tips.text(function(d) {
				return d.Name + " | Position: " + d.PositionZ + " | " + d.Team + " | Overall Time:" + d.TimeBackZ;});
					/*
	//set colour
			  .attr("fill", function(d) {
			  if (d.Team == teamS) { return "rgb(0,121,193)" }
			  else {  return d.Colour }
			  })
			.attr("stroke", "black")
			.attr("stroke-width", 0.5)	
			 .attr("r", function(d) {
			  if (d.Team == teamS) { return 7}
			  else {  return 5 }
			  })         */
				}); 		
			

});

		
			    	</script>

			</body>

</html>
